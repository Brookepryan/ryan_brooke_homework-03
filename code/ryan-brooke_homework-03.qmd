---
title: "ryan-brooke_homework-03"
author: "Brooke Ryan"
format: html
editor: visual
---

# link to forked repository: https://github.com/Brookepryan/ryan_brooke_homework-03.git

# reading in packages/data

```{r}
#suppressing messages/warnings
suppressMessages({
  suppressWarnings({
# general use
library(tidyverse)
library(readxl)
library(here)
library(janitor)

# visualizing pairs
library(GGally)

# model selection
library(MuMIn)

# model predictions
library(ggeffects)

# model tables
library(gtsummary)
library(flextable)
library(modelsummary)

drought_exp <- read_xlsx(path = here("data", 
                                     "Valliere_etal_EcoApps_Data.xlsx"),
                         sheet = "First Harvest")

# quick look at data 
str(drought_exp)
class(drought_exp)
  })
})
```

```{r}
#suppressing messages/warnings
suppressMessages({
  suppressWarnings({
    
# cleaning
drought_exp_clean <- drought_exp %>% 
  clean_names() %>% # nicer column names
  mutate(species_name = case_when( # adding column with species scientific names
    species == "ENCCAL" ~ "Encelia californica", # bush sunflower
    species == "ESCCAL" ~ "Eschscholzia californica", # California poppy
    species == "PENCEN" ~ "Penstemon centranthifolius", # Scarlet bugler
    species == "GRICAM" ~ "Grindelia camporum", # great valley gumweed
    species == "SALLEU" ~ "Salvia leucophylla", # Purple sage
    species == "STIPUL" ~ "Nasella pulchra", # Purple needlegrass
    species == "LOTSCO" ~ "Acmispon glaber" # deerweed
  )) %>% 
  relocate(species_name, .after = species) %>% # moving species_name column after species
  mutate(water_treatment = case_when( # adding column with full treatment names
    water == "WW" ~ "Well watered",
    water == "DS" ~ "Drought stressed"
  )) %>% 
  relocate(water_treatment, .after = water) # moving water_treatment column after water

 })
})
```

## 0. Null model

```{r}
model0 <- lm(total_g ~ 1, # formula
             data = drought_exp_clean) # data frame
```

## 1. total biomass as a function of SLA, water treatment, and species

```{r}
# saturated model
model1 <- lm(total_g ~ sla + water_treatment + species_name,
             data = drought_exp_clean)

par(mfrow = c(2, 2))
plot(model1)
# you might get a warning when you run this code - that is ok!
#diagnostics for sat model look good
```

## 2. total biomass as a function of SLA and water treatment

```{r}
model2 <- lm(total_g ~ sla + water_treatment,
             data = drought_exp_clean)

plot(model2)
```

**look at diagnostics later**

## 3. total biomass as a function of SLA and species

```{r}
model3 <- lm(total_g ~ sla + species_name,
             data = drought_exp_clean)

plot(model3)
```

## 4. total biomass as a function of water treatment and species

```{r}
model4 <- lm(total_g ~ water_treatment +species_name,
             data = drought_exp_clean)

plot(model4)
```

# Making a table

```{r}
# one option for a single model
flextable::as_flextable(model4)

# another option for a single model
gtsummary::tbl_regression(model4)

modelsummary::modelsummary( # this function takes a list of models
  list( 
    "null" = model0, # "model name" = model object
    "model 1" = model1,
    "model 2" = model2,
    "model 3" = model3,
    "model 4" = model4
  )
) 

```

# caption:

**Table 1: Comparison of Linear Regression Models for Predicting Total Growth**

This table shows the coefficients, standard errors, and performance metrics for four linear regression models that predict total growth biomass (`total_g`) based on water treatment and species name. Model 4, which includes both predictors, shows the best performance with the highest R² (0.754) and lowest AIC (-159.2), indicating the most reliable fit for the data.

b.  Write a 5-6 sentence “statistical methods” section. (8 points) Your answer should be in paragraph form and include:

how you addressed the central question(s) (i.e. to examine the influence of \_\_\_\_, \_\_\_\_, and \_\_\_\_ on \_\_\_\_\_, I…) how you chose the final model (i.e. to determine the model that best described \_\_\_\_, I…) how you visually determined that your final model conformed to the assumptions of a linear model (i.e. to evaluate linear model assumptions, I…)

I examined the influence of water tr

c.  Make a visualization of the model predictions with underlying data for your “best” model. (20 points) Show and annotate all your code. For full credit:

make the underlying data more transparent than the model predictions display species names in full (not as species codes like ENCCAL or ESCCAL) display water treatment types in full (not as WW or DS) represent well-watered and drought stressed treatments with different colors use colors that are not the default ggplot() colors facet your plot by species remove the legend finalize the plot Note Make sure that the only output is the visualization!

```{r}
model_4_plot <- ggplot(data = drought_exp_clean, 
       aes(x = water_treatment, 
           y = total_g, 
           color = species_name)) + 
  geom_jitter(width = 0.1, height = 0)

print(model_4_plot)

```

```{r}
ggplot(data = drought_exp_clean, 
       aes(x = water_treatment, 
           y = total_g, 
           shape = species_name)) + 
  geom_jitter(width = 0.1, height = 0)

```

```{r}
ggplot(data = drought_exp_clean, 
       aes(x = water_treatment, 
           y = total_g)) + 
  geom_jitter(width = 0.1, height = 0) +
  facet_wrap(~ species_name)


```

```{r}
ggplot(data = drought_exp_clean, 
       aes(x = water_treatment, 
           y = total_g, 
           color = species_name)) + 
  geom_jitter(width = 0.1, height = 0) +
  facet_wrap(~ species_name)

```

d.  Write a caption for your visualization. (6 points) Include a data citation.

e.  Write a 3-4 sentence results section. (10 points) Your answer should be in paragraph form and address the following points:

what predictors “best” described total mass (include model statistics here)? on average, what differences did you find between water treatments? on average, what differences did you find between species?

# Problem 2. Affective visualization (24 points)

In this problem, you will create an affective visualization using your personal data in preparation for workshop during week 10.

In lecture, we talked about the three vertices of data visualization: 1) exploratory, 2) affective, and 3) communicative. We’ve done a lot of exploratory and communicative visualization, but have yet to think about affective visualization.

When thinking of affective visualization, you can expand your ideas of what data visualization could be. Some examples of affective visualizations include:

Jill Pelto’s paintings Lorraine Woodruff-Long’s warming strips quilt Stefanie Posavec and Giorgia Lupi’s Dear Data project Before starting, update your spreadsheet of observations.

##a. Describe in words what an affective visualization could look like for your personal data (3-5 sentences). (2 points)

## b. Create a sketch (on paper) of your idea. (2 points)

Include a photo of this sketch in your submission.

## c. Make a draft of your visualization. (12 points)

Feel free to be creative with this! You do not have to do this in R. You could create a sculpture, painting, textile object, etc.

If you are making your visualization in R, show the annotated code and the output.

If you are making your visualization outside of R, include a photo of your visualization in your submission.

## d. Write an artist statement. (8 points)

An artist statement gives the audience context to understand your work. Write 4-5 sentences to address:

the content of your piece (what are you showing?) the influences (what did techniques/artists/etc. did you find influential in creating your work?) the form of your work (written code, watercolor, oil painting, etc.) your process (how did you create your work?)

# Problem 3. Statistical critique (36 points)

At this point, you have seen and created a lot of figures for this class. Revisit the paper you chose for your critique and your homework 2, where you described figures or tables in the text. Address the following in full sentences (3-4 sentences each).

For this section of your homework, you will be evaluated on the logic, conciseness, and nuance of your critique.

## a. Revisit and summarize (6 points)

What are the statistical tests the authors are using to address their main research question?

### The authors are using a one way analysis of variance (ANOVA) and two-way ANOVA both followed by Tukey’s post hoc test to address the question of better understand the shell calcification responses of P. fucata to ocean acidification, and to elucidate the molecular mechanisms of this ecologically and economically important species in response to ocean acidification.

## b. Visual clarity (10 points)

How clearly did the authors visually represent their statistics in figures? For example, are the x- and y-axes in a logical position? Do they show summary statistics (means and SE, for example) and/or model predictions, and if so, do they show the underlying data?

### These visualizations are moderately clear representations to those who are skimming the article or do not know much about marine animal calcification. Some aspects could have been more defined, such as the lack of titles and the y-axis labeled “IcT”, considering I had never heard of that measuring unit so could not immediately understand the plot at first glance. The plots did show summary measurements including mean and standard error. The plots do not show underlying data .

## c. Aesthetic clarity (10 points)

How well did the authors handle “visual clutter”? How would you describe the the data:ink ratio?

### The plots are not cluttered at all, I would say that they are almost too bland and uninteresting. The data: ink ratio is good considering they are bar plots.

## d. Recommendations (can be longer than 4 sentences, 10 points)

What recommendations would you make to make the figure better? What would you take out, add, or change? Provide explanations/justifications for each of your recommendations.

### I would recommend making the box fill lighter to show the bottom tail of the SE, adding titles to both, including a key to understand...

Alternatively, if they did not represent their statistics in a figure, what kind of figure would you recommend to them? Describe the x- and y-axes, with any geometries and aesthetics (colors, etc.). Provide enough explanation such that someone would be able to create the figure you describe in code. Provide explanations/justifications for the figure you would recommend.
