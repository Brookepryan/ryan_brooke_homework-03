---
title: "ENVS 193DS Homework 3"
author: "Brooke Ryan"
format: html
editor: visual
---

# link to forked repository:

https://github.com/Brookepryan/ryan_brooke_homework-03.git

# reading in packages/data

```{r}
#suppressing messages/warnings
suppressMessages({
  suppressWarnings({
# general use
library(tidyverse)
library(readxl)
library(here)
library(janitor)
library(dplyr)
library(ggplot2)
    
# visualizing pairs
library(GGally)

# model selection
library(MuMIn)

# model predictions
library(ggeffects)

# model tables
library(gtsummary)
library(flextable)
library(modelsummary)

drought_exp <- read_xlsx(path = here("data", 
                                     "Valliere_etal_EcoApps_Data.xlsx"),
                         sheet = "First Harvest")
                        
# quick look at data 
str(drought_exp)
class(drought_exp)
  })
})

```


```{r}
#suppressing messages/warnings
suppressMessages({
  suppressWarnings({
    
# cleaning
drought_exp_clean <- drought_exp %>% 
  clean_names() %>% # nicer column names
  mutate(species_name = case_when( # adding column with species scientific names
    species == "ENCCAL" ~ "Encelia californica", # bush sunflower
    species == "ESCCAL" ~ "Eschscholzia californica", # California poppy
    species == "PENCEN" ~ "Penstemon centranthifolius", # Scarlet bugler
    species == "GRICAM" ~ "Grindelia camporum", # great valley gumweed
    species == "SALLEU" ~ "Salvia leucophylla", # Purple sage
    species == "STIPUL" ~ "Nasella pulchra", # Purple needlegrass
    species == "LOTSCO" ~ "Acmispon glaber" # deerweed
  )) %>% 
  relocate(species_name, .after = species) %>% # moving species_name column after species
  mutate(water_treatment = case_when( # adding column with full treatment names
    water == "WW" ~ "Well watered",
    water == "DS" ~ "Drought stressed"
  )) %>% 
  relocate(water_treatment, .after = water) # moving water_treatment column after water

 })
})
```

# a. Make a table or list of all the models from class and the last one you constructed on your own. Write a caption for your table
## 0. Null model

```{r}
model0 <- lm(total_g ~ 1, # formula
             data = drought_exp_clean) # data frame
```

## 1. total biomass as a function of SLA, water treatment, and species

```{r}
# saturated model
model1 <- lm(total_g ~ sla + water_treatment + species_name,
             data = drought_exp_clean)

par(mfrow = c(2, 2))
plot(model1)
# you might get a warning when you run this code - that is ok!
#diagnostics for sat model look good
```

## 2. total biomass as a function of SLA and water treatment

```{r}
model2 <- lm(total_g ~ sla + water_treatment,
             data = drought_exp_clean)

plot(model2)
```

**look at diagnostics later**

## 3. total biomass as a function of SLA and species

```{r}
model3 <- lm(total_g ~ sla + species_name,
             data = drought_exp_clean)

plot(model3)
```



## 4. total biomass as a function of water treatment and species

```{r}
model4 <- lm(total_g ~ water_treatment + species_name,
             data = drought_exp_clean)

plot(model4)
```
```{r}
summary(model4)
```
# Making a table

```{r}

modelsummary::modelsummary( # this function takes a list of models
  list( 
    "null" = model0, # "model name" = model object
    "model 1" = model1,
    "model 2" = model2,
    "model 3" = model3,
    "model 4" = model4
  )
) 

```

# Caption:


### Table 1: Comparison of Linear Regression Models for Predicting Total Growth

This table shows the coefficients, standard errors, and performance metrics for four linear regression models that predict total growth biomass (`total_g`) based on water treatment and species name. Model 4, which includes both predictors, shows the best performance with the highest R² (0.754) and lowest AIC (-159.2), indicating the most reliable fit for the data.

e.  Statistical Methods

To examine the influence of specific leaf area (SLA), species, and water treatment on total plant biomass of plants species native to southern California, I conducted a series of linear regression models. I used a null model to establish a baselines, and then four subsequent models comparing different combinations of predictors (SLA, species, water treatment). To determine the model that best described total biomass, I used Akaike Information Criterion (AIC) and R² values. I decided that the model that best described variation in plant bioass is model 4, because it had the highest R² of 0.754 and lowest AIC of -159.2. To evaluate linear model assumptions, I visually inspected diagnostic plots for normality, homoscedasticity, linearity, and outliers.

# c.  Make a visualization of the model predictions with underlying data for your “best” model. (20 points) Show and annotate all your code. For full credit:
- make the underlying data more transparent than the model predictions 
- display species names in full (not as species codes like ENCCAL or ESCCAL) 
- display water treatment types in full (not as WW or DS) 
- represent well-watered and drought stressed treatments with different colors - use colors that are not the default ggplot() colors facet your plot by species remove the legend finalize the plot 
- Note Make sure that the only output is the visualization!



```{r}
ggplot(data = drought_exp_clean, 
       aes(x = water_treatment, 
           y = total_g)) + 
  geom_jitter(width = 0.1, height = 0) +
  facet_wrap(~ species_name)


```

```{r}
ggplot(data = drought_exp_clean, 
       aes(x = water_treatment, 
           y = total_g, 
           color = species_name)) + 
  geom_jitter(width = 0.1, height = 0) +
  facet_wrap(~ species_name)

```

d.  Write a caption for your visualization. (6 points) Include a data citation.


e.  Write a 3-4 sentence results section. (10 points) Your answer should be in paragraph form and address the following points:

what predictors “best” described total mass (include model statistics here)? on average, what differences did you find between water treatments? on average, what differences did you find between species?

# Problem 2. Affective visualization


##a. What would an affective visualization look like for my personal data? 

### An affective visualization of my data would include as many variables as possible. For this, I would probably be visualizing each observation individually and grouping them by day. I want to represent mg, form, pleasure/purpose, and hours of sleep at the very least. I think a drawing similar to the "dear data" project would be most fitting to accomplsih this. 

## b. Visualization sketch: 


## c. Visualization draft: 


## d. Write an artist statement.

An artist statement gives the audience context to understand your work. Write 4-5 sentences to address:

the content of your piece (what are you showing?) the influences (what did techniques/artists/etc. did you find influential in creating your work?) the form of your work (written code, watercolor, oil painting, etc.) your process (how did you create your work?)

# Problem 3. Statistical critique 

## a. Revisit and summarize

The authors are using a one way analysis of variance (ANOVA) and two-way ANOVA both followed by Tukey’s post hoc test to address the question of better understand the shell calcification responses of P. fucata to ocean acidification. Specifically, they are testing the effects of lowered seawater pH on calcium content and shell hardness.

## b. Visual clarity

These visualizations are moderately clear representations to those who are skimming the article or do not know much about marine animal calcification. Some aspects could have been more defined, such as the lack of titles and the y-axis labeled “IcT”, considering I had never heard of that measuring unit so could not immediately understand the plot at first glance. The plots did show summary measurements including mean and standard error. The plots do not show underlying data.

## c. Aesthetic clarity

The plots are not cluttered at all, I would say that they are almost too bland and uninteresting. The data: ink ratio is good considering they are bar plots. 

## d. Recommendations 

I recommend doing a scatter plot to represent each variable instead of a box plot. This way, they could include the underlying data because it is a respectable amount of observations to have in a jitterplot, as well as an errorbarr to provide a clearer respresenattion of mean and standard error. Also, I reccommend specifying IcT as Growth Global Index of length and weight on the y-axis, and even possibly including the equation (IcT = (Ln At - Ln A0)/t]100) somewhere on the plot, or at least in the caption. Lastly, I reccommend including a title for each of their plots, it is confusing to read without one.

